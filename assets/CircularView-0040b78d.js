var pt=Object.defineProperty;var vt=(t,e,o)=>e in t?pt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var N=(t,e,o)=>(vt(t,typeof e!="symbol"?e+"":e,o),o);import{E as le,a3 as Oe,r as w,o as xe,_ as be,c as f,J as R,R as D,Y as we,an as Ve,Q as _t,N as z,a0 as g,ao as Ge,ap as mt,a6 as yt,W as me,w as ee,a as gt,Z as kt,M as Ee,S as de,U as fe,V as xt,X as bt,a5 as wt,b as Mt,K as St}from"./index-d8ad34b5.js";import{c as Tt,i as pe,f as Ct,d as $t,e as ve,g as _e}from"./directives-333953e0.js";import{_ as Me}from"./_plugin-vue_export-helper-c27b6911.js";const ye=Math.PI,ge=2*ye,U=1e-6,At=ge-U;function je(t){this._+=t[0];for(let e=1,o=t.length;e<o;++e)this._+=arguments[e]+t[e]}function Nt(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return je;const o=10**e;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*o)/o+n[a]}}class Pt{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?je:Nt(e)}moveTo(e,o){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+o}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,o){this._append`L${this._x1=+e},${this._y1=+o}`}quadraticCurveTo(e,o,n,a){this._append`Q${+e},${+o},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,o,n,a,i,l){this._append`C${+e},${+o},${+n},${+a},${this._x1=+i},${this._y1=+l}`}arcTo(e,o,n,a,i){if(e=+e,o=+o,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,v=this._y1,r=n-e,c=a-o,y=l-e,u=v-o,d=y*y+u*u;if(this._x1===null)this._append`M${this._x1=e},${this._y1=o}`;else if(d>U)if(!(Math.abs(u*r-c*y)>U)||!i)this._append`L${this._x1=e},${this._y1=o}`;else{let m=n-l,S=a-v,x=r*r+c*c,T=m*m+S*S,_=Math.sqrt(x),k=Math.sqrt(d),b=i*Math.tan((ye-Math.acos((x+d-T)/(2*_*k)))/2),P=b/k,I=b/_;Math.abs(P-1)>U&&this._append`L${e+P*y},${o+P*u}`,this._append`A${i},${i},0,0,${+(u*m>y*S)},${this._x1=e+I*r},${this._y1=o+I*c}`}}arc(e,o,n,a,i,l){if(e=+e,o=+o,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let v=n*Math.cos(a),r=n*Math.sin(a),c=e+v,y=o+r,u=1^l,d=l?a-i:i-a;this._x1===null?this._append`M${c},${y}`:(Math.abs(this._x1-c)>U||Math.abs(this._y1-y)>U)&&this._append`L${c},${y}`,n&&(d<0&&(d=d%ge+ge),d>At?this._append`A${n},${n},0,1,${u},${e-v},${o-r}A${n},${n},0,1,${u},${this._x1=c},${this._y1=y}`:d>U&&this._append`A${n},${n},0,${+(d>=ye)},${u},${this._x1=e+n*Math.cos(i)},${this._y1=o+n*Math.sin(i)}`)}rect(e,o,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+o}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function X(t){return function(){return t}}function Rt(t){let e=3;return t.digits=function(o){if(!arguments.length)return e;if(o==null)e=null;else{const n=Math.floor(o);if(!(n>=0))throw new RangeError(`invalid digits: ${o}`);e=n}return t},()=>new Pt(e)}function Bt(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ue(t){this._context=t}Ue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function qe(t){return new Ue(t)}function Dt(t){return t[0]}function Lt(t){return t[1]}function Xe(t,e){var o=X(!0),n=null,a=qe,i=null,l=Rt(v);t=typeof t=="function"?t:t===void 0?Dt:X(t),e=typeof e=="function"?e:e===void 0?Lt:X(e);function v(r){var c,y=(r=Bt(r)).length,u,d=!1,m;for(n==null&&(i=a(m=l())),c=0;c<=y;++c)!(c<y&&o(u=r[c],c,r))===d&&((d=!d)?i.lineStart():i.lineEnd()),d&&i.point(+t(u,c,r),+e(u,c,r));if(m)return i=null,m+""||null}return v.x=function(r){return arguments.length?(t=typeof r=="function"?r:X(+r),v):t},v.y=function(r){return arguments.length?(e=typeof r=="function"?r:X(+r),v):e},v.defined=function(r){return arguments.length?(o=typeof r=="function"?r:X(!!r),v):o},v.curve=function(r){return arguments.length?(a=r,n!=null&&(i=a(n)),v):a},v.context=function(r){return arguments.length?(r==null?n=i=null:i=a(n=r),v):n},v}function We(t,e,o){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+o)/6)}function Ye(t){this._context=t}Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:We(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:We(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Ft(t){return new Ye(t)}function ze(t){this._context=t}ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,o=t.length;if(o)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),o===2)this._context.lineTo(t[1],e[1]);else for(var n=Ie(t),a=Ie(e),i=0,l=1;l<o;++i,++l)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],t[l],e[l]);(this._line||this._line!==0&&o===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Ie(t){var e,o=t.length-1,n,a=new Array(o),i=new Array(o),l=new Array(o);for(a[0]=0,i[0]=2,l[0]=t[0]+2*t[1],e=1;e<o-1;++e)a[e]=1,i[e]=4,l[e]=4*t[e]+2*t[e+1];for(a[o-1]=2,i[o-1]=7,l[o-1]=8*t[o-1]+t[o],e=1;e<o;++e)n=a[e]/i[e-1],i[e]-=n,l[e]-=n*l[e-1];for(a[o-1]=l[o-1]/i[o-1],e=o-2;e>=0;--e)a[e]=(l[e]-a[e+1])/i[e];for(i[o-1]=(t[o]+a[o-1])/2,e=0;e<o-1;++e)i[e]=2*t[e+1]-a[e+1];return[a,i]}function Et(t){return new ze(t)}const Wt=["d","marker-start","marker-mid","marker-end"],It=le({__name:"SvgLine",props:{points:{},visible:{type:Boolean,default:!0},stroke:{default:"white"},strokeWidth:{default:2},opacity:{default:1},curveStyle:{default:"linear"},markerEnd:{},markerStart:{},markerMid:{},markerLength:{default:10},styleClass:{},style:{}},setup(t){Oe(u=>({"1fb3e84f":l.value,"2402a546":v.value}));const e=w(null),o=t;xe(()=>{r()}),be(()=>{r()});const n=f(()=>{switch(o.curveStyle){case"linear":return qe;case"basis":return Ft;case"natural":return Et;default:return o.curveStyle}}),a=f(()=>Xe().x(u=>u.x).y(u=>u.y).curve(n.value)),i=f(()=>a.value(o.points)||void 0),l=w(0),v=w(0);function r(){var T,_;let d=(_=(T=e.value)==null?void 0:T.getTotalLength())!=null?_:0,m=0;const S=c(e.value,"stroke-width"),x=y(S);if(o.markerStart&&(d-=o.markerLength*x,m-=o.markerLength*x),o.markerEnd){const k=o.markerLength*x;k*2>d?m+=k:d-=k}l.value=d,v.value=m}function c(u,d){let m;const S=u.ownerDocument.defaultView;return S&&S.getComputedStyle?(d=d.replace(/([A-Z])/g,"-$1").toLowerCase(),S.getComputedStyle(u,null).getPropertyValue(d)):u.currentStyle?(d=d.replace(/\-(\w)/g,function(x,T){return T.toUpperCase()}),m=u.currentStyle[d],m):""}function y(u){const d=u.match(/((\d+)(\.\d+)?)(\w+)/);if(d){const m=parseFloat(d[1]);switch(d[4]){case"px":return m;default:return m}}else console.warn(">>> Could not parse stroke width",u);return 0}return(u,d)=>{var m;return u.visible?(R(),D("path",{key:0,ref_key:"refPath",ref:e,d:i.value,class:we(((m=u.styleClass)!=null?m:"")+" cut-off"),style:Ve(u.style),"marker-start":u.markerStart?`url(#${u.markerStart}`:"","marker-mid":u.markerMid?`url(#${u.markerMid}`:"","marker-end":u.markerEnd?`url(#${u.markerEnd}`:""},null,14,Wt)):_t("",!0)}}});const Ot=Me(It,[["__scopeId","data-v-c6db72fd"]]),Vt=["id","refX","refY","markerWidth","markerHeight","orient","markerUnits","viewBox"],Gt=["d"],jt=le({__name:"Marker",props:{markerType:{default:"arrow"},markerName:{default:"arrow"},align:{default:"middle"},width:{default:20},height:{default:20},offsetX:{default:0},offsetY:{default:0},orient:{default:"auto-start-reverse"},markerUnits:{default:"strokeWidth"},styleClass:{default:"default"},style:{}},setup(t){const e=t,o=f(()=>e.height/2+e.offsetY),n=f(()=>{let l=0;return e.align==="start"?l=0:e.align==="middle"?l=e.width/2:e.align==="end"&&(l=e.width),l+e.offsetX}),a=f(()=>[[0,0],[0,e.height],[e.width,e.height/2]]),i=f(()=>Xe().x(l=>l[0]).y(l=>l[1])(a.value)||"");return(l,v)=>(R(),D("defs",null,[z("marker",{id:l.markerName,refX:n.value,refY:o.value,markerWidth:l.width,markerHeight:l.height,orient:l.orient,markerUnits:l.markerUnits,viewBox:`0, 0, ${l.width}, ${l.height}`},[z("path",{d:i.value,class:we(l.styleClass),style:Ve(l.style),opacity:"1"},null,14,Gt)],8,Vt)]))}});const Ut=Me(jt,[["__scopeId","data-v-cc853f51"]]);class qt{constructor(e,o){N(this,"anchor");N(this,"direction");this.anchor=e,this.direction=o}get x(){return this.anchor.value.x}get y(){return this.anchor.value.y}get dx(){return this.direction.value.x}get dy(){return this.direction.value.y}getDirectionPoint(e){return f(()=>{const o=this.direction.value.x-this.anchor.value.x,n=this.direction.value.y-this.anchor.value.y,a=Math.sqrt(o*o+n*n);return a===0?{x:this.anchor.value.x,y:this.anchor.value.y}:{x:this.anchor.value.x+o/a*e,y:this.anchor.value.y+n/a*e}})}}class ke{constructor(e,o,n,a){N(this,"transformation");N(this,"localCenter");N(this,"globalCenter");N(this,"anchorSelection");N(this,"directionSelection");this.localCenter=e||w({x:0,y:0}),this.transformation=o,this.globalCenter=f(()=>this._applyTransformationToPoint(g(this.localCenter))),this.anchorSelection=n,this.directionSelection=a}_applyTransformationToPoint(e){return this.transformation?Tt(g(this.transformation.globalTransform),g(e)):g(e)}_defaultAnchorSelection(e){return this.localCenter}_defaultDirectionSelection(e){return Ge(e)}selectAnchor(e,o=!0){return f(()=>{const n=g(e),a=this.anchorSelection?this.anchorSelection(n):this._defaultAnchorSelection(n);return o?this._applyTransformationToPoint(g(a)):g(a)})}selectDirection(e,o=!0){return f(()=>{const n=this.directionSelection?this.directionSelection(e):this._defaultDirectionSelection(e);return o?this._applyTransformationToPoint(g(n)):g(n)})}getAnchor(e,o=!0){return new qt(this.selectAnchor(e,o),this.selectDirection(e,o))}}function Xt({local:t,transformation:e,anchorSelection:o,directionSelection:n}){return new ke(t,e,o,n)}class an{constructor(e,o=void 0){N(this,"localTransform");N(this,"localTransformMatrix");N(this,"parentTransformation");N(this,"globalTransform");this.localTransform=Ge(e),this.localTransformMatrix=f(()=>{const n=g(this.localTransform);if(n==null)return pe();if(typeof n=="string"){const a=n?Ct(n):void 0,i=a?$t(a):[];return i.length>0?ve(i):pe()}else if(typeof n=="object")return n;return pe()}),this.parentTransformation=o,this.globalTransform=f(()=>(this.localTransformMatrix.value,this.parentTransformation?ve([g(this.parentTransformation.globalTransform),g(this.localTransformMatrix)]):g(this.localTransformMatrix),this.parentTransformation?ve([g(this.parentTransformation.globalTransform),g(this.localTransformMatrix)]):g(this.localTransformMatrix)))}}function Y(...t){return t.filter(e=>e&&e.length>0).join("/")}const He=mt("nodeAnchors",{state:()=>({anchors:new Map}),getters:{getNodeAnchor(t){return(e,o="")=>{let n="";return typeof e=="string"?n=e:e instanceof yt?n=e.key:e instanceof me&&(n=e.node.key),n=Y(o,n),t.anchors.has(n)||t.anchors.set(n,new ke),t.anchors.get(n)}},getTopicAnchor(t){return(e,o,n="",a=void 0)=>{const i=Y(n,e,o,a);return t.anchors.has(i)||t.anchors.set(i,new ke),t.anchors.get(i)}}},actions:{updateTopicAnchor(t,e,o,n="",a=void 0){this.anchors.set(Y(n,t,e,a),o)},updateNodeAnchor(t,e,o=""){this.anchors.set(Y(o,t),e)},removeNodeAnchor(t,e=""){this.anchors.delete(Y(e,t))},removeTopicAnchor(t,e,o="",n=void 0){this.anchors.delete(Y(o,t,e,n))}}});function te(t,e){return(t%e+e)%e}const Yt=["cx","cy","r"],zt=["cx","cy","r"],Ht=["transform","text-anchor"],Zt=le({__name:"CircleNode",props:{node:{},anchorMappingPrefix:{default:""},cx:{default:0},cy:{default:0},r:{default:10},angle:{default:0},styleClass:{default:""},transformation:{},adaptiveRadius:{type:Boolean,default:!0}},setup(t,{expose:e}){const o=He(),n=t,a=w(n.cx),i=w(n.cy),l=w(n.r);ee([()=>n.cx,()=>n.cy,()=>n.r],()=>{a.value=n.cx,i.value=n.cy,l.value=n.r},{immediate:!0});const v=f(()=>{if(!n.adaptiveRadius)return n.r;const _=n.node.predecessorNodes,k=n.node.successorNodes,b=_.length+k.length,P=Math.min(5,Math.pow(1.2,b));return n.r*P/2}),r=f(()=>n.node.node.name),c=f(()=>te(n.angle,360)),y=f(()=>c.value>=270||c.value<=90),u=f(()=>y.value?"start":"end"),d=f(()=>y.value?c.value<=180?c.value/5:(c.value-360)/5:(c.value-180)/5),m=f(()=>{const _=v.value+n.r/5;return y.value?_:-_}),S=_=>f(()=>{const k=g(_).x-n.cx,b=g(_).y-n.cy,P=Math.sqrt(k*k+b*b),q=v.value/P,E=n.cx+k*q,ne=n.cy+b*q;return{x:E,y:ne}}),x=f(()=>({x:n.cx,y:n.cy})),T=Xt({local:x,transformation:void 0,anchorSelection:S});return xe(()=>{o.updateNodeAnchor(n.node.key,T,n.anchorMappingPrefix)}),be(()=>{o.updateNodeAnchor(n.node.key,T,n.anchorMappingPrefix)}),gt(()=>{o.removeNodeAnchor(n.node.key,n.anchorMappingPrefix)}),e({objectAnchor:T}),(_,k)=>(R(),D("g",null,[z("circle",{cx:a.value,cy:i.value,r:_.r*1.5,fill:"none",stroke:"none","pointer-events":"all"},null,8,Yt),z("circle",{cx:a.value,cy:i.value,r:v.value,class:we(_.styleClass)},null,10,zt),z("text",{transform:`translate(${_.cx}, ${_.cy}) rotate(${d.value}) translate(${m.value}, 0) `,x:0,y:0,fill:"var(--q-stroke)","alignment-baseline":"middle","text-anchor":u.value},kt(r.value),9,Ht)]))}}),Kt=["r"],Qt={key:0},Jt=["onClick","onMouseenter","onDblclick"],en=le({__name:"CircularView",props:{name:{default:"CircularView"},nodes:{},selectedNode:{},hoveredNode:{},graphSorting:{default:"flow"},usePubSubConnections:{type:Boolean,default:!0},useServiceConnections:{type:Boolean,default:!1},useBroadcastConnections:{type:Boolean,default:!1},markerWidth:{default:5},markerHeight:{default:4},strokeWidthPubSub:{default:3},strokeWidthService:{default:2},strokeWidthBroadcast:{default:.5},outerRadius:{default:300},maxInnerRadiusFactor:{default:.8},minInnerRadiusFactor:{default:-.5},maxOuterRadiusFactor:{default:2.9},minOuterRadiusFactor:{default:1.4},circleGap:{default:0},connectedGapFactor:{default:1.5},startAngleOffset:{default:-90},showPubSubConnections:{type:Boolean,default:!0},showBroadcastConnections:{type:Boolean,default:!0},showServiceClientConnections:{type:Boolean,default:!0}},emits:["selectedNode","dblclickedNode","hoveredNode"],setup(t,{expose:e,emit:o}){Oe(s=>({"5e7f0eee":r.strokeWidthPubSub,"148da9ac":r.strokeWidthService,"173003f6":r.strokeWidthBroadcast}));const n=He(),a=o;function i(s){s!==null&&a("selectedNode",s.node.key)}function l(s){if(s===null){a("hoveredNode",null);return}a("hoveredNode",s.node.key)}function v(s){s!==null&&a("dblclickedNode",s.node.key)}const r=t,c=w(r.outerRadius),y=f(()=>"marker-"+r.name),u=w(null),d=w(null);function m(){if(u.value){const s=u.value.getBBox();(d.value===null||s.x!==d.value.x||s.y!==d.value.y||s.width!==d.value.width||s.height!==d.value.height)&&(d.value=s)}}function S(s,h,p){return Math.min(Math.abs(s-h),p-Math.abs(s-h))}function x(s,h){return f(()=>{const p=Math.cos(g(s)*Math.PI/180)*g(h),C=Math.sin(g(s)*Math.PI/180)*g(h);return{x:p,y:C}})}function T(s,h){return Math.atan2(h,s)*180/Math.PI}function _(s){var p;const h=typeof s=="string"?s:s.node.key;return(p=H.value.get(h))!=null?p:w(0)}function k(s){var p;const h=typeof s=="string"?s:s.node.key;return(p=Te.value.get(h))!=null?p:w({x:0,y:0})}function b(s,h){let p;return typeof s=="string"?p=s:s instanceof me?p=s.node.key:p=s.key,n.getNodeAnchor(p,r.name).getAnchor(h)}const P=f(()=>new xt(r.nodes)),I=f(()=>P.value.nodes.map(s=>new me(s,P.value))),q=f(()=>new bt(I.value)),E=f(()=>q.value.getConnectionComponents(r.graphSorting,r.usePubSubConnections,r.useServiceConnections,r.useBroadcastConnections)),ne=f(()=>I.value.length),Ze=f(()=>E.value.length),ce=w(0),Ke=f(()=>(E.value.length>1?360:270)-r.circleGap),oe=f(()=>Ke.value/(ne.value+Ze.value*r.connectedGapFactor)),Qe=f(()=>oe.value*r.connectedGapFactor),H=w(new Map);ee([()=>E.value],()=>{var p;const s=new Map;w(0);let h=0;for(const[C,M]of E.value.entries())if(M.length!==0)for(const[L,A]of M.entries()){h++;const Z=h,O=H.value.get(A.node.key),ue=C*Qe.value+Z*oe.value,re=w(((p=O==null?void 0:O.value)!=null?p:0)-ce.value);_e.to(re,{duration:O?2:0,value:ue}),s.set(A.node.key,f(()=>ce.value+re.value))}H.value=s},{immediate:!0});const Se=f(()=>{const s=[...I.value];return s.sort((h,p)=>_(h).value-_(p).value),s}),Te=w(new Map);ee([()=>H.value],()=>{const s=new Map;for(const[h,p]of H.value.entries())s.set(h,x(p,c));Te.value=s},{immediate:!0});const Je=f(()=>{const s=[],h=oe.value*2,C=180-h,M=c.value*r.minInnerRadiusFactor,L=c.value*r.maxInnerRadiusFactor,A=L-M,Z=c.value*r.minOuterRadiusFactor,ue=c.value*r.maxOuterRadiusFactor-Z,re=c.value*2*Math.PI*oe.value/360;for(const[ot,rt]of E.value.entries())for(const[tn,$]of rt.entries()){const Ce=$.nodesPublishedTo,$e=$.nodesClientsConnectedTo,st=$.nodesBroadcastedTo.filter(V=>!Ce.includes(V)&&!$e.includes(V)),se=[];r.showPubSubConnections&&se.push({nodes:Ce,type:"PubSub"}),r.showServiceClientConnections&&se.push({nodes:$e,type:"Service"}),r.showBroadcastConnections&&se.push({nodes:st,type:"Broadcast"}),se.forEach(V=>{V.nodes.forEach(B=>{const at=f(()=>{k($).value.x,k($).value.y,k(B.key).value.x,k(B.key).value.y;const K=_($).value,ae=_(B.key).value,G=ae-K;let F=G;G<=-180?F=G+360:G>-180&&G<=180?F=G:F=G-360;let it=K-F/2;const lt=Math.abs(F);let Ae=F<0,j=c.value,ct=Se.value.indexOf($),ut=Se.value.indexOf(q.value._nodeMap.get(B)),Ne=S(ct,ut,ne.value);if(Ne==1){let W=q.value._nodeMap.get(B).successorNodes.includes($.node)||r.showBroadcastConnections&&V.type==="Broadcast"?re/5:0;F>=0?j=c.value-W:j=c.value+W}else{const J=Math.max(0,lt-h),W=(C-J)/C;Ae?j=Z+ue*(1-W):j=L-A*(1-W)}const Pe=x(it,c.value),Re=b($,Pe.value).anchor.value,Be=b(B,Pe.value).anchor.value,ht=T(Re.x,Re.y),dt=T(Be.x,Be.y);let Q=(ht+dt)/2;Math.abs(te(Q,360)-te(K,360))>90&&Math.abs(te(Q,360)-te(ae,360))>90&&(Q=(Q+180)%360);const De=x(Q,j),ie={x:De.value.x,y:De.value.y},ft=c.value-j,Le=c.value-ft/2;x(K+F*1/6,Le),x(ae-F*1/6,Le),V.type==="PubSub"?r.strokeWidthPubSub:r.strokeWidthService;const he=[];if(Ae&&Ne!=1){const J=x(K,c.value+40),W=x(ae,c.value+40),Fe=(j-c.value)*.5;he.push(b($,J.value).anchor.value,b($,J.value).getDirectionPoint(Fe).value,ie,b(B,W.value).getDirectionPoint(Fe).value,b(B,W.value).anchor.value)}else he.push(b($,ie).anchor.value,ie,b(B,ie).anchor.value);return{points:he,startNode:$.node,endNode:B,type:V.type}});s.push(at)})})}return s});xe(()=>{ee([()=>r.circleGap,()=>r.startAngleOffset],()=>{const h=r.circleGap/2+r.startAngleOffset;_e.to(ce,{duration:0,value:h})},{immediate:!0}),ee([()=>r.outerRadius],()=>{const h=r.outerRadius;_e.to(c,{duration:1,value:h})},{immediate:!0})});const et=wt(()=>{Mt(()=>{m()})},100);be(()=>{et()});function tt(s){var p,C,M;const h=["node"];if(s.node.key==r.selectedNode)h.push("node-selected");else if(s.node.key==r.hoveredNode)h.push("node-hovered");else if(P.value.nodeMap.has((p=r.hoveredNode)!=null?p:"")){const L=s.predecessorNodes,A=s.successorNodes;new Set((C=L==null?void 0:L.concat(A!=null?A:[]).map(O=>O.key))!=null?C:[]).has((M=r.hoveredNode)!=null?M:"")&&h.push("node-hovered-adjacent")}return h.join(" ")}function nt(s){const h=["line"];s.type==="PubSub"?h.push("line-pubsub"):s.type==="Service"?h.push("line-service"):s.type==="Broadcast"&&h.push("line-broadcast");let p=!0;return(r.selectedNode===s.startNode.key||r.selectedNode===s.endNode.key)&&(h.push("line-selected"),p=!1),(r.hoveredNode===s.startNode.key||r.hoveredNode===s.endNode.key)&&(h.push("line-hovered"),p=!1),p&&(r.selectedNode||r.hoveredNode)&&h.push("line-smaller"),h.join(" ")}return e({bBox:d}),(s,h)=>(R(),D("g",{ref_key:"refGRoot",ref:u},[Ee(Ut,{"marker-type":"arrow","marker-name":y.value,align:"end",height:s.markerHeight,width:s.markerWidth,"marker-units":"strokeWidth",class:"marker","offset-x":0},null,8,["marker-name","height","width"]),z("circle",{x:"0",y:"0",fill:"var(--q-stroke)",opacity:"0.04",r:c.value*1},null,8,Kt),(R(),D("g",Qt,[(R(!0),D(de,null,fe(Je.value,(p,C)=>(R(),St(Ot,{key:C,points:p.value.points,"curve-style":"basis","marker-end":y.value,"marker-length":s.markerWidth,"style-class":nt(p.value)},null,8,["points","marker-end","marker-length","style-class"]))),128))])),(R(!0),D(de,null,fe(E.value,(p,C)=>(R(),D("g",{key:C},[(R(!0),D(de,null,fe(p,(M,L)=>(R(),D("g",{onClick:A=>i(M),onMouseenter:A=>l(M),onDblclick:A=>v(M),onMouseleave:h[0]||(h[0]=A=>l(null)),key:L},[Ee(Zt,{node:M,cx:k(M).value.x,cy:k(M).value.y,r:10,"style-class":tt(M),angle:_(M).value,"anchor-mapping-prefix":s.name},null,8,["node","cx","cy","style-class","angle","anchor-mapping-prefix"])],40,Jt))),128))]))),128))],512))}});const ln=Me(en,[["__scopeId","data-v-6c8b7296"]]);export{ln as C,Ut as M,Ot as S,an as T,Xt as a,He as u};
